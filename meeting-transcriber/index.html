<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web会議 文字起こし</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563eb">
    <link rel="icon" href="icon.svg" type="image/svg+xml">
</head>
<body>
    <div class="container">
        <header>
            <h1>🎙️ Web会議 文字起こし</h1>
            <p class="subtitle">Zoom / Teams / Google Meet 対応</p>
        </header>

        <main>
            <!-- 設定パネル -->
            <section class="settings-panel">
                <h2>設定</h2>
                <div class="setting-item">
                    <label for="audioSource">音声入力:</label>
                    <select id="audioSource">
                        <option value="mic">マイク (スマホ対応)</option>
                        <option value="system">システム音声 (PC専用)</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="language">言語:</label>
                    <select id="language">
                        <option value="ja-JP">日本語</option>
                        <option value="en-US">English (US)</option>
                        <option value="en-GB">English (UK)</option>
                        <option value="zh-CN">中文 (简体)</option>
                        <option value="ko-KR">한국어</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="speakerDetection">話者認識:</label>
                    <input type="checkbox" id="speakerDetection" checked>
                    <span class="checkbox-label">有効</span>
                </div>
                <div class="setting-item">
                    <label for="autoSave">自動保存:</label>
                    <input type="checkbox" id="autoSave" checked>
                    <span class="checkbox-label">有効 (1分ごと)</span>
                </div>
            </section>

            <!-- コントロールパネル -->
            <section class="control-panel">
                <button id="startBtn" class="btn btn-primary">
                    <span class="icon">▶</span>
                    録音開始
                </button>
                <button id="stopBtn" class="btn btn-danger" disabled>
                    <span class="icon">⏹</span>
                    録音停止
                </button>
                <div class="status-indicator">
                    <span id="statusDot" class="status-dot"></span>
                    <span id="statusText">待機中</span>
                </div>
                <div id="timer" class="timer">00:00:00</div>
            </section>

            <!-- 音声レベルメーター -->
            <section class="audio-meter-section">
                <h3>音声レベル</h3>
                <div class="audio-meter">
                    <div id="audioLevel" class="audio-level"></div>
                </div>
                <div class="speaker-info">
                    <span>現在の話者:</span>
                    <span id="currentSpeaker" class="speaker-badge">-</span>
                </div>
            </section>

            <!-- 文字起こし結果 -->
            <section class="transcript-section">
                <div class="transcript-header">
                    <h2>文字起こし結果</h2>
                    <div class="transcript-actions">
                        <button id="copyBtn" class="btn btn-small">📋 コピー</button>
                        <button id="exportTxtBtn" class="btn btn-small">📄 TXT</button>
                        <button id="exportJsonBtn" class="btn btn-small">📁 JSON</button>
                        <button id="exportSrtBtn" class="btn btn-small">🎬 SRT</button>
                        <button id="clearBtn" class="btn btn-small btn-warning">🗑️ クリア</button>
                    </div>
                </div>
                <div id="transcript" class="transcript">
                    <p class="placeholder">録音を開始すると、ここに文字起こし結果が表示されます。</p>
                </div>
            </section>

            <!-- 話者管理 -->
            <section class="speaker-management">
                <h2>話者管理</h2>
                <div id="speakerList" class="speaker-list">
                    <p class="placeholder">話者が検出されると、ここに表示されます。</p>
                </div>
                <button id="addSpeakerBtn" class="btn btn-small">+ 話者を追加</button>
            </section>

            <!-- 統計情報 -->
            <section class="stats-section">
                <h2>統計情報</h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-label">総発言数</span>
                        <span id="totalUtterances" class="stat-value">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">総文字数</span>
                        <span id="totalChars" class="stat-value">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">検出話者数</span>
                        <span id="speakerCount" class="stat-value">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">録音時間</span>
                        <span id="recordingDuration" class="stat-value">00:00:00</span>
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <p id="footerTip">💡 ヒント: スマホではマイク入力を選択し、スピーカーから出る音を拾って文字起こしします。</p>
        </footer>
    </div>

    <!-- 話者名編集モーダル -->
    <div id="speakerModal" class="modal">
        <div class="modal-content">
            <h3>話者名を編集</h3>
            <input type="text" id="speakerNameInput" placeholder="話者名を入力">
            <div class="modal-actions">
                <button id="saveSpeakerBtn" class="btn btn-primary">保存</button>
                <button id="cancelSpeakerBtn" class="btn">キャンセル</button>
            </div>
        </div>
    </div>

    <script src="audio-processor.js"></script>
    <script src="speaker-recognition.js"></script>
    <script src="transcription.js"></script>
    <script src="app.js"></script>
</body>
</html>
